# For Claire

## 摘要翻译

地统计学方法在区域层次的攻击数据集上应用较少。本文利用2000年波罗的海三国的偷车数据集，阐述了这些方法在提升对犯罪模式的解释与理解方面的潜力。变异函数是用来描述在种种数据集上的尺度现象的函数；区域间/区域到点的泊松克里金插值是用来由小值问题产生的噪音的。其中，后者也被用来生成对潜在犯罪风险的连续地图，这可以减少大的空间单元的视觉误差。在寻找最似然犯罪聚落方面，犯罪风险的不确定性由基于随机模拟的局部聚落分析来得到。我们利用克里金因子分析来估计局部、区域尺度的犯罪潜在的空间位置和解释变量。然后回归建模用来确定哪些变量在不同尺度上是跟偷车风险有关的。

## 前人发现：Ceccato and Haining 的方法与发现

- 负二项回归模型：
  - 负二项分布：是几何分布的推广。每次实验有成功、失败两种结果，第$r$次成功所需要的试验次数的分布为负二项分布。$$f(k;r, p) = C_{k+r-1}^{r-1}p^r(1-p)^k. $$
- 哑变量：
  - 通常取$\{0,1\}.$在因变量由某些**定性**因素决定的时候，哑变量的加入可以让我们将其分离出来。通过增加变量的个数来增加问题的灵活性。本问题中是为了代表三个国家。
- 空间自相关的显著性：由广义线性模型（GLM）来识别。
- 标准化攻击率：对数转化再进行线性回归
  - 残差空间自回归的建模：一阶同时自回归误差
  - 因为这个模型的残差不是空间自相关的，这个模型是用来进行假设检验的。

结论：没有明显证据表明除了拉脱维亚之外，中期效应都是不明显的。在拉脱维亚，社会变迁变量的解释性是统计显著的，但在其他两个国家，社会变迁的解释性也是显著的，但是方向是相反的。

这是一种小区域分析来解释不同解释变量产生的尺度问题。

某个区域上经济水平的落后，可能会导致其他潜在目标区域的犯罪率的增加。

- 对这些*尺度*和 *可变性*进行识别和制图是一个不能直接做到的事。所以我们需要一些地统计学的知识，比如因子克里金分析（[FKA](https://pubs.acs.org/doi/abs/10.1021/es9022305): Factorial Kriging Analysis As a Tool for Explaining the Complex Spatial Distribution of Metals in Sediments）

## 数据

波罗的海三国2000年的针对107个行政区域的：

- 平均人口（约70,000）
  - 空间异质性很强
- 人口学数据
- 社会学
- 经济指标
- 社会福利

有一些量化问题没有解决（未被报告的犯罪）。

## 地统计学分析

基本概念：

- 犯罪率的定义：
  - 区域名称：$v_α$
  - 犯罪数：$d(v_α)$
  - 人口数：$n(v_α)$
  - **犯罪率**$$z(v_α):=\frac{d(v_α)}{n(v_α)}\times 10,000.$$

问题：当分母很小的时候，这个比值的变动范围会很大。这种现象称为小数问题。我们在设计变异函数和空间预测的时候，要想办法对抗这种现象的产生。

### 变差函数的计算

目的：刻画数据的空间**变异性**。所谓变异性，指的是数据集上，以一个点为核心，随着距离的变化，不同位置上的特征的变化。

我们首先设置一个权重基准，对于每一个点对$(\alpha, \beta), $$$w_{\alpha, \beta}：=\frac{\frac{1}{\frac{1}{n(v_\alpha)}+\frac{1}{n(v_\beta)}}}{∑_{\alpha, \beta}^{N(h)}\frac{1}{\frac{1}{n(v_\alpha)}+\frac{1}{n(v_\beta)}}}.$$可以看出，$w_(\alpha, \beta)$对于所有满足要求的*点对*求和为$1.$ 所以可以作为权重。另一方面，由于每个区域的人口数$n(v)$都至少是$1,$ 所以上式不会出现极端值。

我们根据这个权重基准来定义半变异函数：$$\hat{\gamma}_{R_v}(h):=\frac{1}{2}\sum_{\alpha, \beta}^{N(h)} w_{\alpha, \beta} [z(v_\alpha)-z(v_\beta)]^2-m^*.$$ 其中，$\frac{1}{2}$的来源是：$\alpha$和$\beta$是对称的。$m^*$的物理意义是，距离为$h$的点对，按人口平均的犯罪率。

半变异函数的导出，我猜是杠杆原理/重力模型。假设杠杆的两端分别是重为$n(v_\alpha), n(v_\beta)$的重物，杆长为$h, $ 那么支点放在哪里才能使得它平衡呢？设支点到$\alpha$端距离为$kh, $ 那么我们有$$n(v_\alpha)khg = n(v_\beta)(1-k)hg.$$解得$k=\frac{n(v_\beta)}{n(v_\alpha)+n(v_\beta)}.$ 所以每一边的力矩恰好就是$\frac{1}{\frac{1}{n(v_\alpha)}+\frac{1}{n(v_\beta)}}.$

我们对它可以有几种理解：我们的研究对象是距离带来的犯罪率变差。为了表示的方便，不受正负的限制，我们写成$[z(v_\alpha)-z(v_\beta)]^2$我们要使得这个量在某种正则化规则下，对$v_\alpha, v_\beta$两个地方的作用相同，我们想到的自然是人口修正。对于含有人口的问题，常用的方法是重力模型。重力模型对应到这个问题，是一个二体问题，即求旋转中心。所以得到上面的修正方式。另一种理解是，将距离修正为上面所求的$k. $

总体来看，这个指数可以理解为：将所有点对的旋转中心平移到同一个点，然后求系统的转动惯量。

关于克里金差值技术：根据离散半变异函数/离散协方差函数，进行反卷积操作。将半变异函数补全成连续函数。

关于反卷积的思维：将$3×3$的图像通过**采样**变成$7\times7.$再通过卷积变成$5\times5.$

- 卷积操作的一维形式对应的是序列数据，与滑动平均是相反的，要旋转180度。是一种加权平均。con layer进行对图像卷积提取特征，pool layer对图像缩小一半筛选重要特征，对于经典的图像识别CNN网络，如IMAGENET，最后输出结果是1X1X1000，1000是类别种类。

### 空间预测

这个部分我们需要一些理论基础了。我们可以将统计学，看作概率现象的离散实现，而统计的估计值作为概率参数的无偏估计。也就是说，样本都是依照某种分布产生的。比如犯罪数据：某个地点的犯罪量$d(v_\alpha)$是Poisson分布的一个实现（realization）。该泊松分布的参数是$n(v_\alpha)\times R(v_\alpha).$ 后者是局部犯罪风险，也就是去掉噪音后的犯罪率。这种方法我们称为**泊松-克里金法**。

Choropleth制图的误差来自于人口密集单元的支配，ATP克里金可以用来制作犯罪风险的等势线，可以用来减少前者产生的视觉误差。

*泊松分布的好处在于，它假设了所有计数事件之间的发生都是独立的，而且每次事件的发生都不受等候时间的影响。所以这个分布是真的随机的、无记忆的。指数分布($P(\tau>t)= e^{-\lambda t}$)的无后效性：$P(\tau>t+s|\tau>t)=P(\tau>t+s, \tau>t)/P(\tau>t)=P(\tau>t+s)/P(\tau>t)=e^{-\lambda s}=P(\tau>s).$ 泊松分布（$P(N_t=n)=\frac{\lambda^n}{n!}e^{-\lambda}.$）无后效性的证明是类似的。事实上，泊松分布相当于等候时间为指数分布的计数过程，所以也是无后效的。

- 空间单元$X$的犯罪风险估计：$$\hat{r}(X) = \sum_{i=1}^{K}\lambda_i z(v_i)\\X \in \{v_\alpha, u_s\}$$
  - 其中，$X$可以是空间区域（ATA），也可以是空间上的点（ATP）。
- 克里金方差：$$\sigma^2(X) = E[\hat{r}(X)-r(X)]^2\\ = \bar{C}_R(X, X)-\sum_{i=1}^K \lambda_i\bar{C}_R(v_i, X)-\mu(X)$$
  - 其中，克里金权重$\lambda$和拉格朗日参数$\mu(X)$有待讨论：
- Poisson kriging方程组：
  - 对于数据集中已知的area来说，

### 局部团块分析

### 尺度依赖相关与回归